/*Artikel id's*/
var ids={"_377":"2017_15","_376":"2017_14","_375":"2017_13","_374":"2017_12","_373":"2017_11","_372":"2017_10","_370":"2017_9","_369":"2017_8","_368":"2017_7","_367":"2017_6","_366":"2017_5","_365":"2017_4","_364":"2017_3","_363":"2017_2","_362":"2017_1",
"_360":"2016_16","_359":"2016_15","_358":"2016_14","_357":"2016_13","_356":"2016_12","_355":"2016_11","_353":"2016_10","_352":"2016_9","_351":"2016_8","_349":"2016_7","_348":"2016_6","_347":"2016_5","_346":"2016_4","_345":"2016_3","_344":"2016_2","_343":"2016_1",
"_342":"2015_16","_Vlot!-1":"2015_15","_339":"2015_14","_338":"2015_13","_337":"2015_12","_336":"2015_11","_335":"2015_10","_334":"2015_9","_333":"2015_8","_332":"2015_7","_329":"2015_6","_328":"2015_5","_327":"2015_4","_326":"2015_3","_324":"2015_2","_323":"2015_1",
"_325":"2014_18","_322":"2014_17","_320":"2014_16","_319":"2014_15","_318":"2014_14","_317":"2014_13","_315":"2014_12","_314":"2014_11","_313":"2014_10","_304":"2014_9","_302":"2014_8","_301":"2014_7","_300":"2014_6","_299":"2014_5","_298":"2014_4","_296":"2014_3","_295":"2014_2","_294":"2014_1",
"_293":"2013_15","_292":"2013_14","_290":"2013_13","_289":"2013_12","_288":"2013_11","_287":"2013_10","_286":"2013_9","_283":"2013_8","_279":"2013_7","_277":"2013_6","_276":"2013_5","_275":"2013_4","_274":"2013_3","_273":"2013_2","_272":"2013_1",
"_270":"2012_11","_269":"2012_10","_267":"2012_9","_266":"2012_8","_265":"2012_7","_263":"2012_6","_259":"2012_5","_230":"2012_4","_229":"2012_3","_228":"2012_0","_227":"2012_2","_226":"2012_1",
"_192":"2010_13","_191":"2010_12","_189":"2010_11","_188":"2010_10","_187":"2010_0","_185":"2010_9","_184":"2010_8","_183":"2010_7","_182":"2010_6","_180":"2010_5","_179":"2010_4","_178":"2010_3","_177":"2010_2","_176":"2010_1",
"_175":"2009_12","_174":"2009_11","_162":"2009_10","_160":"2009_9","_159":"2009_8","_158":"2009_7","_156":"2009_6","_154":"2009_5","_153":"2009_4","_151":"2009_3","_150":"2009_2","_148":"2009_1",
"_147":"2008_15","_146":"2008_14","_145":"2008_13","_139":"2008_12","_141":"2008_11","_140":"2008_10","_138":"2008_9","_137":"2008_8","_135":"2008_7","_134":"2008_6","_130":"2008_5","_99":"2008_4","_94":"2008_3","_77":"2008_2","_58":"2008_1",
"_41":"2007_10","_32":"2007_9","_31":"2007_8","_30":"2007_7","_29":"2007_6","_28":"2007_5","_27":"2007_4","_26":"2007_3","_23":"2007_2","_22":"2007_1",
"_40":"2006_10","_39":"2006_9","_38":"2006_8","_37":"2006_7","_36":"2006_6","_35":"2006_5","_34":"2006_4","_21":"2006_3","_20":"2006_2","_19":"2006_1",
"_55":"2005_11","_54":"2005_10","_53":"2005_9","_52":"2005_8","_51":"2005_7","_50":"2005_6","_49":"2005_5","_48":"2005_4","_47":"2005_3","_46":"2005_2","_45":"2005_1",
"_76":"2004_14","_75":"2004_13","_74":"2004_12","_73":"2004_11","_72":"2004_10","_71":"2004_9","_70":"2004_8","_68":"2004_7","_69":"2004_6","_67":"2004_5","_66":"2004_4","_65":"2004_3","_64":"2004_2","_63":"2004_1",
"_92":"2003_14","_91":"2003_13","_90":"2003_12","_89":"2003_11","_88":"2003_10","_87":"2003_9","_86":"2003_8","_85":"2003_7","_84":"2003_6","_83":"2003_5","_82":"2003_4","_81":"2003_3","_80":"2003_2","_79":"2003_1",
"_129":"2002_22","_128":"2002_21","_127":"2002_20","_126":"2002_19","_125":"2002_18","_124":"2002_17","_123":"2002_16","_122":"2002_15","_121":"2002_14","_120":"2002_13","_119":"2002_12","_118":"2002_11","_117":"2002_10","_116":"2002_9","_115":"2002_8","_114":"2002_7","_113":"2002_6","_112":"2002_5","_111":"2002_4","_110":"2002_3","_97":"2002_2","_96":"2002_1",
/*FQ id's*/
"_371":"2018q","_FQ2018.pdf":"2018q","_350":"2017q","_FQ2017.pdf":"2017q","_331":"2016q","_FQ2016.pdf":"2016q","_316":"2015q","_FQ2015.pdf":"2015q","_284":"2014q","_FQ2014.pdf":"2014q","_264":"2013q","_FQ2013.pdf":"2013q","_197":"2012q","_FQ2012.pdf":"2012q","_186":"2011q","_FQ2011.pdf":"2011q","_157":"2010q","_FQ2010.pdf":"2010q","_136":"2009q","_FQ2009.pdf":"2009q","_109":"2008q","_FQ2008.pdf":"2008q","_108":"2007q","_FQ2007.pdf":"2007q","_107":"2006q","_FQ2006.pdf":"2006q","_106":"2005q","_FQ2005.pdf":"2005q","_105":"2004q","_FQ2004.pdf":"2004q","_104":"2003q","_FQ2003.pdf":"2003q","_103":"2002q","_FQ2002.pdf":"2002q","_102":"2001q","_FQ2001.pdf":"2001q","_101":"2000q","_FQ2000.pdf":"2000q","_100":"1999q","_FQ1999.pdf":"1999q"}
//console.log(JSON.stringify(ids));
var menuitems={"0":[0,0,0,0,0],"2017":[1,1,1,1,1],"2016":[1,1,1,1,1],"2015":[1,1,1,1,1],"2014":[1,1,1,1,1],"2013":[1,1,1,1,1],"2012":[1,1,1,1,1],"2011":[1,1,1,1,1],"2010":[1,1,1,1,1],"2009":[1,1,1,1,1],"2008":[1,1,1,1,1],
"2007":[1,1,1,1,1],"2006":[1,1,1,1,1],"2005":[1,1,1,1,1],"2004":[1,1,1,1,1],"2003":[1,1,1,1,1],"2002":[1,1,1,1,1],"2001":[1,0,1,1,1],"2000":[0,0,1,1,1],"1999":[0,0,1,1,1],"1998":[0,0,1,1,1]};
var gs_error="<h2>Pagina niet gevonden!</h2>Ga terug naar de <a href='#' onclick='httpGet(\"home\",true)'>welkomstpagina</a> of kies een schooljaar uit het archiefmenu.";
var currenturl;
var gallery='';
var single=false;
var year='2017';
var selmenu=0;
var checkform=''
if (window.XMLHttpRequest){var xmlhttp=new XMLHttpRequest();}else{var xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");}
xmlhttp.onreadystatechange=function(){
 //console.log(xmlhttp.readyState);
 //console.log(xmlhttp.status);
 if (xmlhttp.readyState==4 && xmlhttp.status==200){
  var content=xmlhttp.responseText;
  document.title=content.match(/<title[^>]*>([\w|\W]*)<\/title>/im)[1];
  document.getElementById("gs_content").innerHTML=content.match(/<body[^>]*>([\w|\W]*)<\/body>/im)[1];
  if (gallery!=''){
   var el=document.getElementById(gallery);
   el.parentNode.removeChild(el);
   gallery='';
  }
  if(single){
   var el=document.getElementById("hb-wrapperhb-single");
   el.parentNode.removeChild(el);
   single=false;
  }
  halkaBox.run("_a"+currenturl,{animation:'fade',theme:'dark',hideButtons:true,preload:2});
  halkaBox.run("hb-single",{animation:'fade',theme:'dark'});
  gallery='hb-wrapper_a'+currenturl;
  single=true;
  if(checkform!=''){gs_checksubmitted(checkform);} 
 }
 else if(xmlhttp.readyState==4){
  document.title="Archief Sint-Teresiacollege Eksaarde";
  document.getElementById("gs_content").innerHTML=gs_error;
 }
}
function getParameterByName(name, url) {
 if (!url) url = window.location.href;
 name = name.replace(/[\[\]]/g, '\\$&');
 var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),results = regex.exec(url);
 if (!results) return null;
 if (!results[2]) return '';
 return decodeURIComponent(results[2].replace(/\+/g, ' '));
}
function _cp(cp,np){document.getElementById(cp).style.display='none';document.getElementById(np).style.display='inline';}
function httpGet(newurl,cm){
 if(cm){
  if(newurl!='home')
  {
   if(newurl.substr(4,1)=='q'){
    changeYear(Number(newurl.substr(0,4))-1,true);
   }
   else{
    changeYear(newurl.substr(0,4),true);
   }
   if(year==0){
    document.getElementById("gs_content").innerHTML=gs_error;
    return;
   }
   if(newurl.substr(4,1)=="k"){changeMenu(3,true);}
   else if(newurl.substr(4,1)=="w"){changeMenu(1,true);}
   else if(newurl.substr(4,3)=="_4o"){changeMenu(4,true);}
   else if(newurl.substr(4,3)=="_4a"){changeMenu(4,true);}
   else if(newurl.substr(4,1)=="f"){changeMenu(4,true);}
   else if(newurl.substr(4,1)=="q"){changeMenu(5,true);}
   else {changeMenu(2,true);}
  } 
 }
 if(newurl.substr(4,1)=='f'){
  var y=parseInt(newurl);
  checkform=String(y-3)+"-"+String(y+1);
 }
 else {
  checkform='';
 }
 currenturl=newurl;
 xmlhttp.open("GET",newurl+".html");
 xmlhttp.send();
}
function changeMenu(m,ncp){
 var om=document.getElementById("gs_top"+selmenu);
 var nm=document.getElementById("gs_top"+m);
 om.className='';
 nm.className='gs_active';
 selmenu=m;
 if(!ncp){
  if(m==0){
   page='home';
  }
  else{ 
   page=year;
   if(m==1){page+='w';}
   else if(m==2){page+='a';}
   else if(m==3){page+='k';}
   else if(m==4){page+='f';}
   else {page=String(Number(year)+1)+'q';}
  } 
  //console.log(page);
  httpGet(page);
 } 
}
function changeYear(y,ncm){ 
 var om=document.getElementById("gs_y"+year);
 var nm=document.getElementById("gs_y"+y);
 var m;
 var jr=Number(y);
 if(isNaN(jr) || jr<1998 || jr>2017){y=0;}
 var mni=menuitems[y]; 
 if(om){om.className='';}
 if(nm){nm.className='gs_active';}
 year=y;
 document.getElementById("gs_top1").style.display=(mni[0])? 'inline-block':'none';
 document.getElementById("gs_top2").style.display=(mni[1])? 'inline-block':'none';
 document.getElementById("gs_top3").style.display=(mni[2])? 'inline-block':'none';
 document.getElementById("gs_top4").style.display=(mni[3])? 'inline-block':'none';
 document.getElementById("gs_top5").style.display=(mni[4])? 'inline-block':'none';
 document.getElementById("gs_top1").setAttribute("href","#"+year+"w");
 document.getElementById("gs_top2").setAttribute("href","#"+year+"a");
 document.getElementById("gs_top3").setAttribute("href","#"+year+"k");
 document.getElementById("gs_top4").setAttribute("href","#"+year+"f");
 document.getElementById("gs_top5").setAttribute("href","#"+String(Number(year)+1)+"q");
 if(y!=0){
  if(!ncm){
   if(mni[0]){m=1;}
   else if(mni[1]){m=2;}
   else if(mni[2]){m=3;}
   else if(mni[3]){m=4;}
   else {m=5;}
   changeMenu(m);
  } 
 } 
}
/*gs_form*/
function validateEmail(email) {
 var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
 return re.test(String(email).toLowerCase());
}
function gs_submit(event){
 if(document.forms['gs_form']['password'].value){return false;}
 var name=String(document.forms['gs_form']['name'].value).trim();
 var email=String(document.forms['gs_form']['email'].value).trim();
 if(!name){alert('Voer je naam in!');return false;}
 if(email){if(!validateEmail(email)){alert('Ongeldig e-mailadres!');return false;}}
 document.getElementById('gs_formwait').innerHTML='<b>Even geduld, je verzoek wordt verzonden...</b>';
 document.getElementById('gs_form').style.display = 'none';
 document.getElementById('gs_formwait').style.display = 'block';
 var id='AKfycbzctYanHLu-YH4sazYdPNMgv7PxewU_v3uh2v8SGpw1x5-SGFnw';
 var url='https://script.google.com/macros/s/'+id+'/exec';
 if (window.XMLHttpRequest){var xhr=new XMLHttpRequest();}else{var xhr=new ActiveXObject("Microsoft.XMLHTTP");}
 xhr.open('POST', url);
 //xhr.withCredentials = true;
 xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
 xhr.onreadystatechange = function() {
  if(xhr.readyState === 4) {
   if(xhr.status === 200) {
    var res=JSON.parse(xhr.responseText);
    if(res.result=='success'){
     var res2=JSON.parse(res.data);
     //console.log(res2.year[0]);
     if(window.sessionStorage){window.sessionStorage.setItem(res2.year[0],true);}
     document.getElementById('gs_formwait').style.display = 'none';
     document.getElementById('gs_fotolinks').style.display = 'block';
     return;
    }
   }
   document.getElementById('gs_formwait').innerHTML='<b>Verzoek mislukt. Probeer opnieuw...</b>';
   document.getElementById('gs_form').style.display = 'block';
  }
 };
 var t=new Date();
 var d=encodeURIComponent('name') + '=' + encodeURIComponent(name);
 d+='&'+encodeURIComponent('email') + '=' + encodeURIComponent(email);
 d+='&'+encodeURIComponent('message') + '=' + encodeURIComponent(document.forms['gs_form']['message'].value);
 d+='&'+encodeURIComponent('year') + '=' + encodeURIComponent(document.forms['gs_form']['year'].value);
 d+='&'+encodeURIComponent('date') + '=' + encodeURIComponent(t.toLocaleString());
 xhr.send(d);
 return false;
}
function gs_checksubmitted(y) {
 if(window.sessionStorage){
  if(window.sessionStorage.getItem(y)){
   document.getElementById('gs_form').style.display = 'none';
   document.getElementById('gs_fotolinks').style.display = 'block';
   return true;
  };
 }
 document.getElementById('gs_form').style.display = 'block';
 return false;
}
window.onload=function(){
 var page,id
 page=window.location.hash;
 if(page!=''){
  page=page.substr(1);
 }
 else{
  page=getParameterByName("page");
 } 
 if (page==null){
  page=getParameterByName("album");
  if(page!=null){
   if(page=='98-99' || page=='95-99'){
    page='1998f';
   }
   else if(page=='96-00'){
    page='1999f';
   }
   else{ 
    page='20'+String(Number(page.substr(3,2))-1)+'f';
   }
  } 
  else{  
   id=getParameterByName("id");
   if(id!=null){
    page=ids["_"+id.split(":")[0]];
    if(page==undefined){
     page=id;
    }
   }
   else{
    page="home";
   }
  } 
 }
 httpGet(page,true); 
};